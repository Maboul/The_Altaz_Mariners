#textdomain wesnoth-The_Altaz_Mariners

[scenario]
	id=greystone_port-a
	name="Greystone Port"
	map_data="{~add-ons/The_Altaz_Mariners/maps/greystone_port.map}" 
	random_start_time="no"
	turns=-1  
	experience_modifier=150
	victory_when_enemies_defeated=no
	allow_new_game=no
	force_lock_settings=yes
	{DEFAULT_SCHEDULE_FIRST_WATCH}
	{MOOD_NORMAL} 

	####################################################################################
	# Side Defintions
	####################################################################################
	
	[side]
		side=1
		canrecruit=yes
		name=Largo
		id=Largo
		save_id=Largo
		controller=human
		team_name=mariners
		user_team_name= _ "Mariners"
		team_lock=yes
		share_vision=all
		gold=0
		village_gold=0
		income=-2
		type=Thug
		fog=no
		shroud=no
		recruit="Ruffian,Thief,Footpad,Thug,Poacher"
	[/side]

	[side]
		side=2
		canrecruit=yes
		name=Hugo
		id=Hugo
		save_id=Hugo
		controller=human
		team_name=mariners
		user_team_name= _ "Mariners"
		team_lock=yes
		share_vision=all
		gold=0
		village_gold=0
		income=-2
		type=Poacher
		fog=no
		shroud=no
		recruit="Ruffian,Thief,Footpad,Thug,Poacher"
	[/side]
	
	[side]
		side=3
		controller=ai
		team_name=mariners,foes
		no_leader=yes
		allow_player=no
		user_team_name= _ "Friends"
		team_lock=yes
	[/side]
	
	[side]
		side=4
		controller=ai
		team_name=foes
		no_leader=yes
		allow_player=no
		user_team_name= _ "Foes"
		team_lock=yes
		disallow_observers=yes
	[/side]
	
	####################################################################################
	# Objectives
	####################################################################################

    [event]
    name=prestart
        [objectives]
            side=0
            [objective]
                description= _ "Trade, recruit and make merry!"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of mariners"
                condition=lose
            [/objective]
        [/objectives]
        {TAM_EXIT 40 12}
        {VARIABLE scenario greystone_port}
    [/event]
    
	####################################################################################
	# Intro
	####################################################################################
	
	####################################################################################
	# Placing Units
	####################################################################################
	
	[event]
    name=prestart
		{TAM_PLACE_FOLLOWERS}
		{TAM_PLACE_LEADER 3 TAM_Cut_Throat 33 11 Rusty {TRAIT_CRUEL}{TRAIT_STRONG}}
		[+unit]
			profile=portraits/Rusty.png
		[/unit]
		{TAM_PLACE_NPC 3 TAM_Pickpocket 39 7 Chot}
		{TAM_PLACE_NPC 3 Poacher 29 8 Andre}
		{TAM_PLACE_NPC 3 Ruffian 29 11 Hector}
		{TAM_PLACE_NPC 3 TAM_Shipmate 34 15 Yran}
		{TAM_PLACE_NPC 3 Thief 22 4 Megan}
		[+unit]
			gender=female
		[/unit]
		{GENERIC_UNIT 3 (Trapper) 33 13}
		{GENERIC_UNIT 3 (Thief) 27 6}
		{GENERIC_UNIT 3 (Footpad) 33 8}
		# Steven
		[if]
			{CONDITION subquest_steven less_than 4}
			[then]
				{TAM_PLACE_NPC 3 Ruffian 25 12 Steven}
				[+unit]
					profile=portraits/Steven.png
					[modifications]
						{TRAIT_LOYAL}
						{TRAIT_QUICK}
					[/modifications]
				[/unit]
			[/then]
		[/if]
		# Crow
		[if]
			{CONDITION subquest_blade numerical_equals 0}
			{CONDITION dahazi_beach equals b}
			[or]
				{CONDITION subquest_blade numerical_equals 0}
				{CONDITION judro_pits equals b}
			[/or]
			[then]
				{TAM_PLACE_NPC 3 Assassin 34 6 Crow}
			[/then]
		[/if]
		[if]
			{CONDITION subquest_blade numerical_equals 1}
			[or]
				{CONDITION subquest_blade numerical_equals 2}
			[/or]
			[then]
				{TAM_PLACE_NPC 3 Assassin 31 2 Crow}
			[/then]
		[/if]
		# Tohman
		[if]
			{CONDITION subquest_blade less_than_equal_to 4}
			[then]
				{TAM_PLACE_NPC 3 Trapper 40 3 Tohman}
				{TAM_PLACE_NPC 3 Thug 36 5 Bodd}
			[/then]
		[/if]
		[if]
			{CONDITION subquest_blade numerical_equals 5}
			[then]
				{TAM_PLACE_NPC 4 Trapper 40 3 Tohman}
			[/then]
		[/if]
		# Nippy
		[if]
			{CONDITION subquest_nippy greater_than_equal_to 4}
			{CONDITION subquest_nippy less_than 7}
			[then]
				{TAM_PLACE_NPC 3 "TAM_Rogue Necromancer" 31 15 Nippy}
				[+unit]
					[modifications]
						{TRAIT_LOYAL}
						{TRAIT_INTELLIGENT}
					[/modifications]
				[/unit]
			[/then]
		[/if]
		[if]
			{CONDITION subquest_nippy numerical_equals 7}
			[then]
				{TAM_PLACE_NPC 4 "TAM_Rogue Necromancer" 31 15 Nippy}
				[+unit]
					[modifications]
						{TRAIT_LOYAL}
						{TRAIT_INTELLIGENT}
					[/modifications]
				[/unit]
				{MOOD_BATTLE}
				{GENERIC_UNIT 4 Banebow 31 14}
			[/then]
		[/if]
		[if]
			{CONDITION subquest_nippy greater_than_equal_to 8}
			{CONDITION subquest_nippy less_than 10}
			[then]
				{TAM_PLACE_NPC 3 "TAM_Rogue Necromancer" 31 15 Nippy}
				[+unit]
					[modifications]
						{TRAIT_LOYAL}
						{TRAIT_INTELLIGENT}
					[/modifications]
				[/unit]
			[/then]
		[/if]
    [/event]
    
	####################################################################################
	# Placing Images
	####################################################################################
	
	{TAM_PLACING_PLAYER_VESSEL 41 13}
    
	[event]
	name=prestart	
		{PLACE_IMAGE scenery/leanto.png 29 9}
		[item]
			x,y=41,9
			image=units/transport/boat.png~TC(3,magenta)
		[/item]
		# If Palmer has not been raided already
		[if]
			{CONDITION subquest_palmer numerical_equals 0}
			[then]
				{MODIFY_TERRAIN Wwf 41 11}
				[item]
					x,y=41,11
					image=units/transport/pirate-galleon.png~TC(3,magenta)
				[/item]
				[store_locations]
					x="10,10"
					y="9,10"
					variable=jewels_xy
					[or]
						find_in=jewels_xy
					[/or]
				[/store_locations]
			[/then]
		[/if]
	[/event]

	####################################################################################
	# Events
	####################################################################################
	
	{TAM_GLOBAL_EVENTS}
	{TAM_TRADING_PORT 36 7 greystone (scenery/tent-ruin-1.png)}
	{TAM_GAMBLING_DEN 31 13 scenery/tent-ruin-1.png}
	{TAM_TAVERN 31 7 scenery/tavern.png}
	{TAM_YEZZA 26 9 18 10}
	
	{TAM_RANDOM_DIALOGUE id=Megan (_ "Hey, handsome.") (_ "Rusty is a dark horse, that's for sure.") (_ "Watch your step, there's some real shady characters around here.")}
	
	[event]
	name=moveto
		[filter]
            side=1,2
            canrecruit=yes
            [filter_adjacent]
                id=Hector
            [/filter_adjacent]
  		[/filter]
  		[if]
		{CONDITION subquest_blade greater_than_equal_to 3}
		{CONDITION subquest_blade less_than 7}
			[then]
				[message]
					speaker=Hector
					message=_ "You're looking for the Black Blade aren't you?"
				[/message]
				[message]
					speaker=unit
					message=_ "Maybe."
				[/message]
				[message]
					speaker=Hector
					message=_ "Rusty ain't too fond of that lot, but I says they talk some sense."
				[/message]
				[message]
					speaker=unit
					message=_ "Have you tried to find them?"
				[/message]
				[message]
					speaker=Hector
					message=_ "Nay, but I did hear some sailor claiming he'd found their hideout. Somewhere in the north west he said it was. That's all I know."
				[/message]
				{VARIABLE log_blade.location_rumour yes}
			[/then]
		[/if]
	[/event]
	
	##########################################
	# Ship Raid
	##########################################
	
	# Chot's clue
	[event]
	name=moveto
		[filter]
            side=1,2
            canrecruit=yes
            [filter_adjacent]
                id=Chot
            [/filter_adjacent]
  		[/filter]
  		[if]
			{CONDITION subquest_palmer numerical_equals 0}
			[then]
				[message]
					speaker=unit
					message=_ "What are you up to? I spy a man with a shifty stance."
				[/message]
				[message]
					id=Chot
					message=_ "Well, I ain't gonna be robbing you now, am I?"
				[/message]
				[message]
					speaker=unit
					message=_ "So who are you going to rob?"
				[/message]
				[message]
					id=Chot
					message=_ "If you must know, I'm waiting for a chance to nip on board the ship over there. I heard it's stacked with jewels."
				[/message]
				[message]
					speaker=unit
					message=_ "I'm sure they won't have left it unguarded. Good luck with that."
				[/message] 
			[/then]
		[/if]
		[if]
			{CONDITION subquest_palmer numerical_equals 2}
			[then]
				[message]
					speaker=Chot
					message=_ "So first you jumped my raid, and now you want to chinwag? Get lost."
				[/message]
			[/then]
		[/if]
		[if]
			{CONDITION subquest_palmer numerical_equals 3}
			[then]
				[message]
					speaker=Chot
					message=_ "I heard Palmer bit it. You're not much of a thief, are ye? More like a murderer methinks!"
				[/message]
			[/then]
		[/if]
	[/event]
	
	# Boarding for the first time
	[event]
		name=moveto
		[filter]
			x=41
			y=11
			side=1,2
		[/filter]
		[if]
			{CONDITION subquest_palmer numerical_equals 0}
			[then]
				{MODIFY_TERRAIN ZWCe 3 9}
				{MODIFY_TERRAIN ZWCe 3 10}
				{MODIFY_TERRAIN ZWCe 3 11}
				{MODIFY_TERRAIN ZWCe 4 9}
				{MODIFY_TERRAIN ZWCe 4 10}
				{MODIFY_TERRAIN ZWCe 5 9}
				{MODIFY_TERRAIN ZWCe 5 11}
				{MODIFY_TERRAIN ZWCe 6 9}
				{MODIFY_TERRAIN ZWCe 6 10}
				{MODIFY_TERRAIN ZWCe 7 9}
				{MODIFY_TERRAIN ZWCe 7 11}
				{MODIFY_TERRAIN ZWCe 8 9}
				{MODIFY_TERRAIN ZWCe 8 10}
				
				{MODIFY_TERRAIN ZWCe 4 8}
				{MODIFY_TERRAIN ZWCe 6 8}
				{MODIFY_TERRAIN ZWCe 8 8}
				{MODIFY_TERRAIN ZWCe 10 8}
				{MODIFY_TERRAIN ZWCe 4 11}
				{MODIFY_TERRAIN ZWCe 6 11}
				{MODIFY_TERRAIN ZWCe 8 11}
				{MODIFY_TERRAIN ZWCe 10 11}
				{MODIFY_TERRAIN ZWCe 9 9}
				{MODIFY_TERRAIN ZWCe 9 11}
				{MODIFY_TERRAIN ZWCe 10 9}
				{MODIFY_TERRAIN ZWCe 10 10}
				{MODIFY_TERRAIN ZWCe 11 9}
				{MODIFY_TERRAIN ZWCe 11 11}
				{MODIFY_TERRAIN ZWCe 12 9}
				{MODIFY_TERRAIN ZWCe 12 10}
				{MODIFY_TERRAIN ZWCe 13 10}
				{MODIFY_TERRAIN ZWKe 5 10}
				{MODIFY_TERRAIN ZWKe 11 10}
				{MODIFY_TERRAIN Ww^ZBw| 5 8}
				{MODIFY_TERRAIN ZWCe^Zwv 7 10}
				{MODIFY_TERRAIN ZWCe^Zwv 9 10}
				
				{PLACE_IMAGE items/chest.png 10 9}
				{PLACE_IMAGE items/chest.png 10 10}
				{TAM_PLACE_IMMOBILE_UNIT 4 Bandit 9 10}
				[+unit]
					name=Palmer
					id=Palmer
				[/unit]
				{GENERIC_UNIT 4 Footpad 5 10}
				{GENERIC_UNIT 4 Ruffian 13 10}
				{GENERIC_UNIT 4 Ruffian 10 11}
			[/then]
		[/if]
	[/event]
	
	# Boarding
	[event]
		name=moveto
		first_time_only=no
		[filter]
			x=41
			y=11
			side=1,2
			[filter_location]
                terrain=Wwf
            [/filter_location]
		[/filter]
		{TAM_STORE_UNIT x=$x1 y=$y1 ({VARIABLE_OP stored_unit.moves add 1})}
		{TAM_TELEPORT x=$x1 y=$y1 5 8}
		{TAM_SCROLL_TO 5 8}
		{TAM_REDRAW}
		{VARIABLE subquest_palmer 1}
	[/event]
	
	# Disembarking
	[event]
		name=moveto
		first_time_only=no
		[filter]
			x=5
			y=8
			side=1,2
			[filter_location]
                terrain=Ww^ZBw|
            [/filter_location]
		[/filter]
		{TAM_TELEPORT x=$x1 y=$y1 41 11}
		{TAM_SCROLL_TO 41 11}
	[/event]
	
	[event]
		name=moveto
		[filter]
			x=3-10
			y=8-11
			side=1,2
		[/filter]
		[message]
			id=Palmer
			message=_ "Get off my ship at once!"
		[/message]
	[/event]
	
	[event]
		name=die
		[filter]
			id=Palmer
		[/filter]
		[message]
			id=Palmer
			message=_ "You devil!"
		[/message]
		{VARIABLE subquest_palmer 3}
	[/event]
	
	[event]
		name=moveto
		[filter]
			x=10,10
			y=9,10
		[/filter]
		{VARIABLE subquest_palmer 2}
	[/event]
	
	##########################################
	# Rusty
	##########################################
	
	[event]
		name=moveto
		[filter]
            side=1,2
            canrecruit=yes
            [filter_adjacent]
                id="Rusty"
            [/filter_adjacent]
        [/filter]
		[message]
			speaker=unit
			message=_ "I take it you are in charge round here?"
		[/message]
		[message]
			id=Rusty
			message=_ "In a manner of speaking. But this ain't no kingship. Watch your step."
		[/message]
	[/event]
	
	[event]
		name=moveto
		first_time_only=no
		[filter]
            side=1,2
            canrecruit=yes
            [filter_adjacent]
                id=Rusty
            [/filter_adjacent]
        [/filter]
        
		[message]
			speaker=narrator
			image=wesnoth-icon.png
			message= _ "What will you do?"
			# Walk on
			[option]
				message=_ "Walk on"
				[command]
				[/command]
			[/option]
			# Ask about Marco
			[option]
				message=_ "<span color='{TAM_BLUE}'>Ask what he knows of Marco</span>"
				[show_if]
					{CONDITION avalon equals z}
				[/show_if]
				[command]
					[message]
						speaker=unit
						message=_ "I'm looking for a man called Marco. Has he been here?"
					[/message]
					[message]
						id=Rusty
						message=_ "How should I know? I got a good knack for faces, but I see a lot coming through here."
					[/message]
					[message]
						speaker=unit
						message=_ "Well, the man I seek is my brother. Perhaps you remember a likeness?"
					[/message]
					[message]
						id=Rusty
						message=_ "I'd remember a face as ugly as yours. I don't."
					[/message]
				[/command]
			[/option]
			# Ask about the storm
			[option]
				message=_ "<span color='{TAM_BLUE}'>Ask about the storm</span>"
				[show_if]
					{CONDITION log_storm.seen equals yes}
					{CONDITION log_storm.heard_rumour not_equals yes}
				[/show_if]
				[command]
					[message]
						speaker=unit
						message=_ "You noticed that strange storm brewing just south of here?"
					[/message]
					[message]
						id=Rusty
						message=_ "It's nothing. The only thing that's strange is how much Yran's been ranting about it."
					[/message]
				[/command]
			[/option]
			# Ask about The Black Blade
			[option]
				message=_ "<span color='{TAM_BLUE}'>Ask what he knows about the Black Blade</span>"
				[show_if]
					{CONDITION subquest_blade greater_than_equal_to 2}
				[/show_if]
				[command]
					[message]
						speaker=unit
						message=_ "Know anything about the Black Blade?"
					[/message]
					[message]
						id=Rusty
						message=_ "Trumped up pirates they are, nothing more."
					[/message]
					[message]
						speaker=unit
						message=_ "Sounds like something the king would say."
					[/message]
					[message]
						id=Rusty
						message=_ "Listen! I ain't no royalist - but I ain't no fool either. When it comes to Tylon, the best way to avoid the chop is to keep your head down."
					[/message]
				[/command]
			[/option]
			# Other News - Nothing
			[option]
				message=_ "<span color='{TAM_BLUE}'>Enquire about other news</span>"
				[show_if]
					{CONDITION subquest_nippy less_than 4}
				[/show_if]
				[command]
					[message]
						speaker=unit
						message=_ "What's been going on round here?"
					[/message]
					[message]
						id=Rusty
						message=_ "What's it to you? You some sort of spy? You're gonna have to try harder than that."
					[/message]
					[message]
						speaker=unit
						message=_ "Forget it."
					[/message]
				[/command]
			[/option]
			# Other News - Nippy
			[option]
				message=_ "<span color='{TAM_BLUE}'>Enquire about other news</span>"
				[show_if]
					{CONDITION subquest_nippy greater_than_equal_to 4}
					{CONDITION subquest_nippy less_than 7}
					[or]
						{CONDITION subquest_nippy numerical_equals 12}
					[/or]
				[/show_if]
				[command]
					[message]
						speaker=unit
						message=_ "What's been going on round here?"
					[/message]
					# If Nippy is waiting
					[if]
						{CONDITION subquest_nippy greater_than_equal_to 4}
						{CONDITION subquest_nippy less_than 7}
						[then]
							[message]
								id=Rusty
								message=_ "Well, some crazy wizard rolled into town recently. He's got it in for a couple of pirates who kicked him out of his home or something. He's a troublemaker if you ask me."
							[/message]
						[/then]
					[/if]
					# If Nippy is killed
					[if]
						{CONDITION subquest_nippy numerical_equals 12}
						[then]
							[message]
								id=Rusty
								message=_ "Didn't you hear? Some idiot started raising the dead. Don't try it again!"
							[/message]
						[/then]
					[/if]
				[/command]
			[/option]
			# Ask him to join you (pre-war)
			[option]
				message=_ "<span color='{TAM_BLUE}'>Ask if he will join you</span>"
				[show_if]
					{CONDITION fort_liberty equals z}
				[/show_if]
				[command]
					[message]
						speaker=unit
						message=_ "Rusty, we're looking to hire a crew - you'd fit right in."
					[/message]
					[message]
						id=Rusty
						message=_ "Watch it. You'd fit right in a grave."
					[/message]
				[/command]
			[/option]
			# Ask him to join you (war)
			[option]
				message=_ "<span color='{TAM_BLUE}'>Ask if he will join you</span>"
				[show_if]
					{CONDITION fort_liberty not_equals z}
				[/show_if]
				[command]
					[message]
						speaker=unit
						message=_ "Rusty, fancy joining our assault on King Tylon?"
					[/message]
					[message]
						id=Rusty
						message=_ "No. You will all die. And it will be a good riddance."
					[/message]
				[/command]
			[/option]
			# Ask if he has seen crow
			[option]
				message=_ "<span color='{TAM_BLUE}'>Ask if he has seen Crow</span>"
				[show_if]
					{CONDITION subquest_blade numerical_equals 3}
				[/show_if]
				[command]
					[message]
						speaker=unit
						message=_ "Know you of one called Crow? He was often seen in this port."
					[/message]
					[message]
						id=Rusty
						message=_ "Aye, but seen no longer. He died a few days back."
					[/message]
					[message]
						speaker=unit
						message=_ "What? How did it happen?"
					[/message]
					[message]
						id=Rusty
						message=_ "It won't do you any favours asking so many questions. All I know is that Tohman found the body."
					[/message]
					{VARIABLE subquest_blade 4}
				[/command]
			[/option]
			# Ask about the ankh
			[option]
				message=_ "<span color='{TAM_BLUE}'>Ask if he has seen Darcus' ankh</span>"
				[show_if]
					{CONDITION subquest_darcus numerical_equals 1}
				[/show_if]
				[command]
					[message]
						speaker=unit
						message=_ "Any of your thieves come across a holy ankh? Brother Darcus said a pickpocket took it."
					[/message]
					[message]
						id=Rusty
						message=_ "Why would I tell you?"
					[/message]
					[message]
						speaker=unit
						message=_ "Because if you don't you'll have one mean mage on your case."
					[/message]
					[message]
						id=Rusty
						message=_ "Look, stuff like that don't hang around. They'd sell it on, wouldn't they? Try looking somewhere posh."
					[/message]
				[/command]
			[/option]
		[/message]
		
	[/event]
	
	##########################################
	# Andre
	##########################################
	
	[event]
	name=moveto
		[filter]
			x=29
			y=9
			side=1,2
		[/filter]
		[message]
			speaker=unit
			message=_ "This seems to be some sort of plaque. Says here Greystone Port is built on the site of an old fortress."
		[/message]
		[message]
			id=Andre
			message=_ "Sightseeing, are we?"
		[/message]
		[message]
			speaker=unit
			message=_ "Mind your own business, fool."
		[/message]
	[/event]

	##########################################
	# Crow
	##########################################
	
	[event]
	name=moveto
		[filter]
            side=1,2
            canrecruit=yes
            [filter_adjacent]
                id=Crow
                x=34
                y=6
            [/filter_adjacent]
  		[/filter]
		[message]
			speaker=Crow
			message=_ "You are the brothers from Altaz?"
		[/message]
		[message]
			speaker=unit
			message=_ "Who are you?"
		[/message]
		[message]
			speaker=Crow
			message=_ "We can't talk here. Meet me in the woods north of the port."
		[/message]
		{VARIABLE subquest_blade 1}
		{TAM_STORE_UNIT type=Assassin id=Crow (
		{VARIABLE stored_unit.goto_x 31}
		{VARIABLE stored_unit.goto_y 2}
		)}
	[/event]
	
	[event]
	name=moveto
		[filter]
            side=1,2
            canrecruit=yes
            [filter_adjacent]
                id=Crow
                x=30-33
                y=1-3
            [/filter_adjacent]
  		[/filter]
  		[if]
		{CONDITION subquest_blade numerical_equals 2}
			[then]
				[message]
					speaker=Crow
					message=_ "Deliver the scroll, then we talk."
				[/message]
			[/then]
		[/if]
		[if]
		{CONDITION subquest_blade numerical_equals 1}
			[then]
				[message]
					speaker=unit
					message=_ "What's going on?"
				[/message]
				[message]
					speaker=Crow
					message=_ "It's safer here. The King has ears in even the shadiest of ports."
				[/message]
				[message]
					speaker=unit
					message=_ "The royals are after you as well?"
				[/message]
				[if]
					{CONDITION dahazi_beach equals b}
					[then]
						[message]
							speaker=Crow
							message=_ "Indeed, we have much in common. We heard of your escape from Altaz with some interest. However, it was your efforts on Dahazi that convinced us."
						[/message]
					[/then]
				[/if]
				[if]
					{CONDITION judro_pits equals b}
					[then]
						[message]
							speaker=Crow
							message=_ "Indeed, we have much in common. We heard of your escape from Altaz with some interest. However, it was your efforts on Judro that convinced us."
						[/message]
					[/then]
				[/if]
				[message]
					speaker=unit
					message=_ "Convinced you of what? You don't make much sense right now."
				[/message]
				[message]
					speaker=Crow
					message=_ "You went to Altaz as common pirates. Perhaps you have returned as something more. That is what I hope to learn."
				[/message]
				[message]
					speaker=Crow
					message=_ "Tell me, what know you of the Black Blade?"
				[/message]
				[message]
					speaker=unit
					message=_ "Let me guess. It's some sort of ancient magic weapon?"
				[/message]
				[message]
					speaker=Crow
					message=_ "Cease the jesting, my friend. I wish to help. Tylon lost more than a pair of petty criminals when you escaped. A king who rules through fear alone cannot allow his power to be questioned. The royals are after you."
				[/message]
				[message]
					speaker=unit
					message=_ "They've not caught up with us yet. I don't see how you can help us."
				[/message]
				[message]
					speaker=Crow
					message=_ "You think you can forever outrun the royal ships? You who are trusting enough to follow a stranger into the woods? Next time it will be a royal blade that awaits you."
				[/message]
				[message]
					speaker=unit
					message=_ "Enough of this. What is it you want?"
				[/message]
				[message]
					speaker=Crow
					message=_ "There is a war coming. The Black Blade is poised at the throat of our wretched ruler, yet there is still much to do. We need your help."
				[/message]
				[message]
					speaker=unit
					message=_ "I would gladly see the back of Tylon, but it seems a folly to think the royals can be toppled so easily. What is it you would have us do?"
				[/message]
				[message]
					speaker=Crow
					message=_ "You've already proved your ability, yet we need to make sure of your loyalty. We have an agent in Fort Bastille, an insider among their ranks. Take this scroll and deliver it to him, then return to me. Such an errand may help forge some trust."
				[/message]
				[message]
					speaker=unit
					message=_ "Very well, we shall see about this."
				[/message]
				{VARIABLE subquest_blade 2}
				{TAM_ITEM_ADDED}
				{VARIABLE inventory.scroll_crow 1}
			[/then]
		[/if]
	[/event]
	
	[event]
	name=moveto
		[filter]
			x=30-34
			y=1-3
			side=1,2
		[/filter]
		[if]
			{CONDITION subquest_blade numerical_equals 3}
			[then]
				[message]
					speaker=unit
					message=_ "Where's Crow? He asked us to come back and see him."
				[/message]
				[message]
					id=Hugo
					message=_ "Maybe we should ask the locals."
				[/message]
			[/then]
		[/if]
	[/event]
	
	##########################################
	# Tohman
	##########################################
	
	[event]
	name=moveto
		[filter]
            side=1,2
            canrecruit=yes
            [filter_adjacent]
                id=Tohman
            [/filter_adjacent]
  		[/filter]
  		[if]
			{CONDITION subquest_blade less_than 3}
			[then]
				[message]
					speaker=Tohman
					message=_ "Fine day for fishing."
				[/message]
			[/then]
		[/if]
  		[if]
			{CONDITION subquest_blade numerical_equals 3}
			[then]
				[message]
					speaker=unit
					message=_ "Have you seen Crow? He was in these parts recently."
				[/message]
				[message]
					speaker=Tohman
					message=_ "Get lost."
				[/message]
			[/then]
		[/if]
  		[if]
			{CONDITION subquest_blade numerical_equals 4}
			[then]
				[message]
					speaker=unit
					message=_ "Tohman, Rusty said you found Crow's body. Do you know what happened?"
				[/message]
				[message]
					speaker=Tohman
					message=_ "Lay off, you ain't getting none of it."
				[/message]
				[message]
					speaker=unit
					message=_ "You looted his corpse? How did he die?"
				[/message]
				[message]
					speaker=Tohman
					message=_ "You should stay out of this. I ain't giving you nothing."
				[/message]
				[message]
					speaker=unit
					message=_ "Look, we're just trying to..."
				[/message]
				[message]
					speaker=Tohman
					message=_ "Sod off!"
				[/message]
				{MOOD_BATTLE}
				{TAM_STORE_UNIT id=Tohman side=3 ({VARIABLE stored_unit.side 4})}
				{VARIABLE subquest_blade 5}
			[/then]
		[/if]
	[/event]
	
	# When Tohman is attacked, Bodd joins in
	[event]
	name=attack_end
		[filter]
			side=1,2
		[/filter]
		[filter_second]
			id="Tohman"
			side=4
		[/filter_second]
		[message]
			speaker=Bodd
			message=_ "Tohman's in trouble!"
		[/message]
		{TAM_STORE_UNIT id=Bodd side=3 ({VARIABLE stored_unit.side 4})}
	[/event]
	# When Bodd is attacked, Torl joins in
	[event]
	name=attack_end
		[filter]
			side=1,2
		[/filter]
		[filter_second]
			id="Bodd"
			side=4
		[/filter_second]
		{TAM_PLACE_NPC 4 Footpad 38 7 Torl}
		[message]
			speaker=Torl
			message=_ "Bodd's in trouble!"
		[/message]
	[/event]
	
	# When Bodd dies
	[event]
	name=die
		[filter]
			id="Bodd"
			side=4
		[/filter]
		[store_locations]
			x=$x1
			y=$y1
			variable=bodd_corpse_xy
			[or]
				find_in=bodd_corpse_xy
			[/or]
		[/store_locations]
	[/event]
	
	# When Torl dies
	[event]
	name=die
		[filter]
			id="Torl"
			side=4
		[/filter]
		[store_locations]
			x=$x1
			y=$y1
			variable=torl_corpse_xy
			[or]
				find_in=torl_corpse_xy
			[/or]
		[/store_locations]
	[/event]
		
	# When Tohman dies
	[event]
	name=die
		[filter]
			id="Tohman"
			side=4
		[/filter]
		{MOOD_NORMAL}
		[message]
			speaker=Largo
			message=_ "Let's search him, sounds like he found something on Crow."
		[/message]
		[message]
			speaker=second_unit
			message=_ "Look, Tohman was carrying this dagger."
		[/message]
		[message]
			speaker=Largo
			message=_ "Doesn't look much like a fighting weapon. Too fancy for a trapper like Tohman."
		[/message]
		[message]
			speaker=Hugo
			message=_ "Let me see... seems to be made from some sort of black metal. And it's oddly serrated at the blade's point."
		[/message]
		[message]
			speaker=Largo
			message=_ "Well, I'm guessing this is the key to finding out what Crow was on about."
		[/message]
		{TAM_ITEM_ADDED}
		{VARIABLE inventory.black_blade 1}
		{VARIABLE subquest_blade 6}
		# To be resurrected later in the Nippy event
		[store_locations]
			x=$x1
			y=$y1
			variable=tohman_corpse_xy
			[or]
				find_in=tohman_corpse_xy
			[/or]
		[/store_locations]
	[/event]

	##########################################
	# Yran
	##########################################

	[event]
	name=moveto
		[filter]
            side=1,2
            canrecruit=yes
            [filter_adjacent]
                id=Yran
            [/filter_adjacent]
  		[/filter]
		[message]
			speaker=Yran
			message=_ "Have you seen the omens?"
		[/message]
		[message]
			speaker=unit
			message=_ "Of what do you speak, stranger?"
		[/message]
		[message]
			speaker=Yran
			message=_ "The dark skies in the south. A mighty storm. I sense trouble brewing."
		[/message]
		# If players have not yet seen the storm
		[if]
			{CONDITION log_storm.seen not_equals yes}
			[then]
				[message]
					speaker=unit
					message=_ "I sense you're a loon."
				[/message]
			[/then]
		[/if]
		# If players have seen the storm, they hear a rumour
		[if]
			{CONDITION log_storm.seen equals yes}
			{CONDITION log_storm.heard_rumour not_equals yes}
			[then]
				[message]
					speaker=unit
					message=_ "You are right, I myself have seen strange clouds hanging upon the seas not far from here."
				[/message]
				[message]
					speaker=Yran
					message=_ "It bodes not well."
				[/message]
				[message]
					speaker=unit
					message=_ "What do you think it means?"
				[/message]
				[message]
					speaker=Yran
					message=_ "I'm not sure, but by my reckoning it's the work of the ice wizards. I've heard they play with thunder."
				[/message]
				[message]
					speaker=unit
					message=_ "You really think the Brotherhood of Ice can conjure a storm the breadth of the ocean?"
				[/message]
				[message]
					speaker=Yran
					message=_ "I heard of stranger tales in my time."
				[/message]
				{VARIABLE log_storm.heard_rumour yes}
			[/then]
		[/if]
		# If player's have learned of the storm barrier
		[if]
			{CONDITION log_storm.orb_info equals yes}
			[then]
				[message]
					speaker=unit
					message=_ "You're right. There's more to that storm than you know."
				[/message]
				[message]
					speaker=Yran
					message=_ "What do you mean?"
				[/message]
				[message]
					speaker=unit
					message=_ "It doesn't concern you. Stay out of it."
				[/message]
				[message]
					speaker=Yran
					message=_ "Suit yourself, idiot."
				[/message]
			[/then]
		[/if]
	[/event]
	
	##########################################
	# Steven
	##########################################
	
	[event]
	name=moveto
		[filter]
            side=1,2
            canrecruit=yes
            [filter_adjacent]
                id=Steven
            [/filter_adjacent]
  		[/filter]
  		# If the players have met his father, but not steven before
  		[if]
			{CONDITION subquest_steven numerical_equals 0}
			{CONDITION log_marco.leene equals yes}
			[then]
				[message]
					speaker=unit
					message=_ "Hello Steven. We ran into your old man on our travels."
				[/message]
				[message]
					id=Steven
					message=_ "Wot nonsense! I heard he croaked."
				[/message]
				[message]
					speaker=unit
					message=_ "Well, actually..."
				[/message]
				[message]
					id=Steven
					message=_ "Can't you see I'm a-grieving? Get out of here!"
				[/message]
				{VARIABLE subquest_steven 3}
			[/then]
		[/if]
  		# If the players have met both Steven and his father
  		[if]
			{CONDITION subquest_steven numerical_equals 2}
			{CONDITION log_marco.leene equals yes}
			[then]
				[message]
					speaker=unit
					message=_ "Hello again Steven. We met your father on our travels."
				[/message]
				[message]
					id=Steven
					message=_ "I heard he croaked."
				[/message]
				[message]
					speaker=unit
					message=_ "Um, no, he's doing fine."
				[/message]
				[message]
					id=Steven
					message=_ "Really?"
				[/message]
				[message]
					speaker=unit
					message=_ "Er, yeah. He made quite a fortune down in the south."
				[/message]
				[message]
					id=Steven
					message=_ "I knew he'd come good. What a man! Say, are you headed that way again? Wouldn't need another pair of hands would ya?"
				[/message]
				[message]
					speaker=unit
					message=_ "Hmm, I guess it couldn't hurt."
				[/message]
				[message]
					id=Steven
					message=_ "I'll travel with you till we meet the old man. Can't wait to see him again."
				[/message]
				{VARIABLE subquest_steven 4}
				{TAM_STORE_UNIT id=Steven side=3 (
				{VARIABLE stored_unit.side $side_number}
				{VARIABLE stored_unit.moves $stored_unit.max_moves}
				{VARIABLE stored_unit.overlays misc/hero-icon.png}
				{VARIABLE stored_unit.upkeep 0}
				)}
				[modify_unit]
					[filter]
						id=Steven
						side=$side_number
						type=Ruffian
					[/filter]
					[modifications]
						{TRAIT_FOLLOWER}
					[/modifications]
				[/modify_unit]
			[/then]
		[/if]
  		# If the players have not met his father yet
  		[if]
			{CONDITION subquest_steven numerical_equals 1}
			{CONDITION log_marco.leene not_equals yes}
			[then]
				[message]
					id=Steven
					message=_ "Hey, it's you again. One of dem brothers - which one are you?"
				[/message]
				[message]
					speaker=unit
					message=_ "I'm $unit.id|."
				[/message]
				[message]
					id=Steven
					message=_ "Catch wind of me old man, did you?"
				[/message]
				[message]
					speaker=unit
					message=_ "Afraid not. We haven't exactly been looking for him."
				[/message]
				[message]
					id=Steven
					message=_ "Well, keep your eyes open, mate!"
				[/message]
				[message]
					speaker=unit
					message=_ "I will, if you keep your mouth shut."
				[/message]
				[message]
					id=Steven
					message=_ "Alright! Alright!"
				[/message]
			[/then]
		[/if]
		# If the players have not met steven yet
  		[if]
			{CONDITION subquest_steven numerical_equals 0}
			{CONDITION log_marco.leene not_equals yes}
			[then]
				[message]
					id=Steven
					message=_ "Hey, you look familiar. What's your name?"
				[/message]
				[message]
					speaker=unit
					message=_ "I'm pretty sure I've never met you before."
				[/message]
				[message]
					id=Steven
					message=_ "Hmm, maybe not. Say, do you have a brother?"
				[/message]
				[message]
					speaker=unit
					message=_ "Well, yes. There's one of them over there. The other brother is proving somewhat harder to track down."
				[/message]
				[message]
					id=Steven
					message=_ "He weren't a bloke called Marco, was he? You sure look like him."
				[/message]
				[message]
					speaker=unit
					message=_ "Yes! Marco is my brother. Did you meet him? Where is he now?"
				[/message]
				[message]
					id=Steven
					message=_ "No idea, mate. He dropped by about a year ago - took me old man off with him. Lured by the coin, he was. Never seen him since."
				[/message]
				[message]
					speaker=unit
					message=_ "You've no idea where they went?"
				[/message]
				[message]
					id=Steven
					message=_ "Southwest I think. Set sail for some promised land, like they all do."
				[/message]
				[message]
					speaker=unit
					message=_ "Thanks, that might be useful."
				[/message]
				[message]
					id=Steven
					message=_ "Hey, if you bump into the old geezer, say hello for me. His name's Leene. Tell him I'm doing okay. Staying outta trouble anyways."
				[/message]
				[message]
					speaker=unit
					message=_ "Will do. Goodbye now."
				[/message]
				{VARIABLE log_marco.steven yes}
				{VARIABLE subquest_steven 1}
			[/then]
		[/if]
	[/event]
	
	##########################################
	# Nippy
	##########################################
	
	 # Option to give him the skull
	[event]
	name=moveto
	first_time_only=no
		[filter]
            side=1,2
            canrecruit=yes
            [filter_adjacent]
                id=Nippy
                side=3
            [/filter_adjacent]
  		[/filter]
  		[filter_condition]
			{CONDITION subquest_nippy numerical_equals 6}
  		[/filter_condition]
  		[message]
			speaker=narrator
			image=wesnoth-icon.png
			message= _ "What will you do?"
			# Walk on
			[option]
				message=_ "Walk on"
				[command]
				[/command]
			[/option]
			# Give him a skull
			[option]
				message=_ "<span color='{TAM_BLUE}'>Give him a skull</span>"
				[show_if]
					{CONDITION subquest_nippy numerical_equals 6}
					{CONDITION inventory.skull greater_than_equal_to 1}
				[/show_if]
				[command]
					[message]
						speaker=unit
						message=_ "I've got a skull for you."
					[/message]
					[message]
						speaker=Nippy
						message=_ "Let me see. Yes, this will suffice. Still want to see the miracle?"
					[/message]
					{VARIABLE_OP inventory.skull add -1}
					[message]
						speaker=unit
						message=_ "Go ahead..."
					[/message]
					{PLAY_SOUND magic-dark.ogg}
					{MOOD_BATTLE}
					{GENERIC_UNIT 4 Banebow 31 14}
					[+unit]
						animate=yes
					[/unit]
					{TAM_REDRAW}
					[message]
						speaker=unit
						message=_ "What is this?"
					[/message]
					[message]
						speaker=Nippy
						message=_ "You don't remember me? You don't remember the adept you had thrown out of the brotherhood?"
					[/message]
					[message]
						speaker=unit
						message=_ "I remember how you tricked us into a stupid experiment and set a skeleton on us. All we did was let your elders know what they were dealing with."
					[/message]
					[message]
						speaker=Nippy
						message=_ "I don't need those idiots any longer, but nor do I much care for the idiot stood before me."
					[/message]
					{TAM_STORE_UNIT id=Nippy side=3 ({VARIABLE stored_unit.side 4})}
					[message]
						speaker=unit
						message=_ "This is crazy!"
					[/message]
					{VARIABLE subquest_nippy 7}
				[/command]
			[/option]
		[/message]
	[/event]
	
	# Initial dialogue when they first encounter Nippy on Greystone Port
	[event]
	name=moveto
		[filter]
            side=1,2
            canrecruit=yes
            [filter_adjacent]
                id=Nippy
                side=3
            [/filter_adjacent]
  		[/filter]
  		[filter_condition]
			{CONDITION subquest_nippy greater_than_equal_to 4}
			{CONDITION subquest_nippy less_than 6}
  		[/filter_condition]
  		[message]
			speaker=Nippy
			message=_ "Hey, want to see a miracle?"
		[/message]
		[message]
			speaker=unit
			message=_ "I guess so. What sort of miracle?"
		[/message]
		[message]
			speaker=Nippy
			message=_ "It's a surprise, but I'll need you to bring me something first."
		[/message]
		[message]
			speaker=unit
			message=_ "Anything in particular?"
		[/message]
		[message]
			speaker=Nippy
			message=_ "A skull. I know they're probably easy to come by in your line of work, but I need a skull from a man long dead."
		[/message]
		[if]
		{CONDITION inventory.skull less_than 1}
			[then]
				[message]
					speaker=unit
					message=_ "Right. If I happen to come by such a thing I'll remember you."
				[/message]
				[message]
					speaker=Nippy
					message=_ "That is well, because I have a good memory too."
				[/message]
			[/then]
		[/if]
		{VARIABLE subquest_nippy 6}
  	[/event]
	
	# Dialogue when Nippy is hostile
	[event]
	name=attack_end
		[filter]
			side=1,2
		[/filter]
		[filter_second]
			id="Nippy"
			side=4
		[/filter_second]
		[filter_condition]
			{CONDITION second_unit.hitpoints greater_than 10}
  		[/filter_condition]
		[message]
			speaker=Nippy
			message=_ "Feeble!"
		[/message]
	[/event]
	
	# Beating Nippy into submission
	[event]
	name=attack_end
		[filter]
			side=1,2
			#canrecruit=yes
		[/filter]
		[filter_second]
			id="Nippy"
			side=4
		[/filter_second]
		[filter_condition]
			{CONDITION second_unit.hitpoints less_than_equal_to 10}
			{CONDITION second_unit.hitpoints greater_than_equal_to 1}
  		[/filter_condition]
		[message]
			speaker=Nippy
			message=_ "Halt!"
		[/message]
		[message]
			canrecruit=yes
			side=$side_number
			message=_ "What? The brotherhood can't protect you now."
		[/message]
		[message]
			speaker=Nippy
			message=_ "You have the claim on my life, just as I once endangered yours. Are we not now equals?"
		[/message]
		[message]
			speaker=narrator
			image=wesnoth-icon.png
			message= _ "What will you do?"
			# Continue fighting
			[option]
				message=_ "<span color='{TAM_BLUE}'>Continue fighting</span>"
				[command]
					[message]
						canrecruit=yes
						side=$side_number
						message=_ "Not at all. We're still alive and you're going to die. There's a big difference."
					[/message]
				[/command]
			[/option]
			# Let him live
			[option]
				message=_ "<span color='{TAM_BLUE}'>Let him live</span>"
				[command]
					[message]
						canrecruit=yes
						side=$side_number
						message=_ "It's not equal from where I stand."
					[/message]
					[message]
						speaker=Nippy
						message=_ "You lack that which I have. Spare me and my magic will serve you."
					[/message]
					[message]
						canrecruit=yes
						side=$side_number
						message=_ "No way, you're nothing but trouble. However, you are also a fool. Let this be a lesson."
					[/message]
					{MOOD_NORMAL}
					{VARIABLE subquest_nippy 8}
					{TAM_STORE_UNIT side=4 id=Nippy ({VARIABLE stored_unit.side 3})}
					[message]
						speaker=Nippy
						message=_ "Lesson learned. My humble apologies..."
					[/message]
					[message]
						canrecruit=yes
						side=$side_number
						message=_ "Cheeky sod."
					[/message]
				[/command]
			[/option]
		[/message]
	[/event]
	
	# On a return visit change the variable
	[event]
	name=start
  		[if]
		{CONDITION subquest_nippy numerical_equals 8}
			[then]
				{VARIABLE subquest_nippy 9}
			[/then]
		[/if]
	[/event]
	
	# On a return visit Nippy wants to join them
	[event]
	name=moveto
		[filter]
            side=1,2
            canrecruit=yes
            [filter_adjacent]
                id=Nippy
                side=3
            [/filter_adjacent]
  		[/filter]
  		[if]
		{CONDITION subquest_nippy numerical_equals 9}
			[then]
				[message]
					speaker=Nippy
					message=_ "Please help me."
				[/message]
				[message]
					speaker=unit
					message=_ "What did you say?"
				[/message]
				[message]
					speaker=Nippy
					message=_ "I have nothing else now, nowhere to go. My pledge of loyalty is all I can give."
				[/message]
				[message]
					speaker=unit
					message=_ "Are you serious?"
				[/message]
				[message]
					speaker=Nippy
					message=_ "I'm afraid so. Take you with me and my magic is yours."
				[/message]
				[message]
					speaker=Hugo
					message=_ "He would be a useful crew member..."
				[/message]
				[message]
					speaker=Largo
					message=_ "It's a deal, but one false move and I'll finish the job."
				[/message]
				[message]
					speaker=Nippy
					message=_ "I shan't deceive you."
				[/message]
				{TAM_STORE_UNIT side=3 id=Nippy (
				{VARIABLE stored_unit.side $side_number}
				{VARIABLE stored_unit.moves $stored_unit.max_moves}
				{VARIABLE stored_unit.overlays misc/hero-icon.png}
				{VARIABLE stored_unit.upkeep 0}
				)}
				[modify_unit]
					[filter]
						id=Nippy
						side=$side_number
						type="TAM_Rogue Necromancer"
					[/filter]
					[modifications]
						{TRAIT_FOLLOWER}
					[/modifications]
				[/modify_unit]
				{VARIABLE subquest_nippy 10}
			[/then]
		[/if]
	[/event]
  	
  	# Players kill Nippy in battle
	[event]
	name=die
		[filter]
			id="Nippy"
			side=4
		[/filter]
		[message]
			canrecruit=yes
			side=$side_number
			message=_ "I glad we won't be running into him again."
		[/message]
		[message]
			canrecruit=yes
			[not]
				side=$side_number
			[/not]
			message=_ "What's that he dropped?"
		[/message]
		[store_locations]
			x=$x1
			y=$y1
			variable=nippys_scroll_xy
			[or]
				find_in=nippys_scroll_xy
			[/or]
		[/store_locations]
		{PLACE_IMAGE items/scroll.png $x1 $y1}
		{VARIABLE subquest_nippy 11}
	[/event]
	
	# Picking up the scroll
	[event]
	name=moveto
		[filter]
			side=1,2
			canrecruit=yes
			[filter_location]
				find_in=nippys_scroll_xy
			[/filter_location]
		[/filter]
		[remove_item]
			x,y=$x1,$y1
			image=items/scroll.png
		[/remove_item]
		[store_locations]
			variable=nippys_scroll_xy
			find_in=nippys_scroll_xy
			[not]
				x,y=$x1,$y1
			[/not]
		[/store_locations]
		[message]
			speaker=unit
			message= _ "It's some sort of incantation, let's see..."
		[/message]
		[message]
			canrecruit=yes
			[not]
				side=$side_number
			[/not]
			message=_ "Hang on, wait!"
		[/message]
		{PLAY_SOUND magic-dark.ogg}
		{TAM_PLACE_NPC 4 "Skeleton Archer" $x1 $y1 "Nippy the Dead"}
		[+unit]
			animate=yes
		[/unit]
		[message]
			canrecruit=yes
			[not]
				side=$side_number
			[/not]
			message=_ "Too late..."
		[/message]
		[message]
			speaker=unit
			message= _ "So that's how he did it! Seems an easy trick to master."
		[/message]
		{VARIABLE subquest_nippy 12}
		[if]
			[have_location]
				find_in=tohman_corpse_xy
			[/have_location]
			[or]
				[have_location]
					find_in=bodd_corpse_xy
				[/have_location]
			[/or]
			[or]
				[have_location]
					find_in=torl_corpse_xy
				[/have_location]
			[/or]
			[then]
				# Ressurrect the recently fallen
				[if]
					[have_location]
						find_in=tohman_corpse_xy
					[/have_location]
					[then]
						{TAM_SCROLL_TO $tohman_corpse_xy.x $tohman_corpse_xy.y}
						{PLAY_SOUND magic-dark.ogg}
						{TAM_PLACE_NPC 4 "Skeleton Archer" $tohman_corpse_xy.x $tohman_corpse_xy.y "Tohman the Dead"}
						[+unit]
							animate=yes
						[/unit]
						{CLEAR_VARIABLE tohman_corpse_xy}
					[/then]
				[/if]
				[if]
					[have_location]
						find_in=bodd_corpse_xy
					[/have_location]
					[then]
						{TAM_SCROLL_TO $bodd_corpse_xy.x $bodd_corpse_xy.y}
						{PLAY_SOUND magic-dark.ogg}
						{TAM_PLACE_NPC 4 "Skeleton" $bodd_corpse_xy.x $bodd_corpse_xy.y "Bodd the Dead"}
						[+unit]
							animate=yes
						[/unit]
						{CLEAR_VARIABLE bodd_corpse_xy}
					[/then]
				[/if]
				[if]
					[have_location]
						find_in=torl_corpse_xy
					[/have_location]
					[then]
						{TAM_SCROLL_TO $torl_corpse_xy.x $torl_corpse_xy.y}
						{PLAY_SOUND magic-dark.ogg}
						{TAM_PLACE_NPC 4 "Skeleton" $torl_corpse_xy.x $torl_corpse_xy.y "Torl the Dead"}
						[+unit]
							animate=yes
						[/unit]
						{CLEAR_VARIABLE torl_corpse_xy}
					[/then]
				[/if]
				[message]
					canrecruit=yes
					[not]
						side=$side_number
					[/not]
					message=_ "You fool, you've brought back everyone we killed earlier!"
				[/message]
			[/then]
		[/if]
		[message]
			speaker=Rusty
			message=_ "What the hell is going on?"
		[/message]
		[message]
			speaker=unit
			message= _ "Hang on, there's another bit here, I think I can just..."
		[/message]
		[message]
			canrecruit=yes
			[not]
				side=$side_number
			[/not]
			message=_ "No!"
		[/message]
		{PLAY_SOUND magic-dark.ogg}
		[modify_unit]
			[filter]
				side=4
				type=Skeleton,Skeleton Archer
			[/filter]
			side=$side_number
			overlays="misc/loyal-icon.png"
			[modifications]
				{TRAIT_LOYAL}
			[/modifications]
		[/modify_unit]
		[message]
			speaker=unit
			message= _ "Yes! All sorted. Looks like we got ourselves some loyal helpers."
		[/message]
		[message]
			speaker=Rusty
			message=_ "It looks to me like you've been messing with stuff you shouldn't be. Get out of here!"
		[/message]
	[/event]
	
[/scenario]